<!DOCTYPE html>
<html lang="pt-br">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>iCummenical - A integração em suas mãos</title>

    <!-- Bootstrap Core CSS -->
    <link href="../vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="../vendor/morrisjs/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
        crossorigin="anonymous">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.2/css/bulma.min.css">
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>

    <style>
        /* Icon set - http://ionicons.com */
        @import url(http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css);
        @import url(https://fonts.googleapis.com/css?family=Raleway:400,500);
    
        figure.snip1237 {
            font-family: 'Raleway', Arial, sans-serif;
            position: relative;
            float: left;
            overflow: hidden;
            margin: 20px 20px;
            1%;
            min-width: 400px;
            max-width: 250px;
            width: 100%;
            background: #1a1a1a;
            color: #ffffff;
            text-align: left;
    
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.15);
            background-image: -webkit-linear-gradient(top, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.3) 100%);
            background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.3) 100%);
            -webkit-box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.75);
            -moz-box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.75);
            box-shadow: 5px 5px 5px 0px rgba(0, 0, 0, 0.75);
    
        }
    
        figure.snip1237 * {
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            -webkit-transition: all 0.3s ease;
            transition: all 0.3s ease;
        }
    
        figure.snip1237 .image {
            height: 250px;
            overflow: hidden;
            position: relative;
        }
    
    
        figure.snip1237 h3 {
            margin: 0 0 3px;
            font-weight: 900;
            font-size: 15px;
        }
    
        figure.snip1237 p {
            margin: 0;
        }
    
        /* ----------------------------------------------------WHITESPACE START */
    
        figure.snip1237 figcaption {
            /* padding order: top right bottom left */
            padding: 5px 20px 15px 20px;
            background-color: #ffffff;
            color: #000000;
            position: relative;
            font-size: 0.9em;
        }
    
        figure.snip1237 figcaption p {
            margin-bottom: 15px;
        }
    
        figure.snip1237 figcaption:before {
            position: absolute;
            content: '';
            z-index: 2;
            bottom: 100%;
            left: 0;
            width: 100%;
            height: 40px;
            background-image: -webkit-linear-gradient(top, transparent 0%, #ffffff 100%);
            background-image: linear-gradient(to bottom, transparent 0%, #ffffff 100%);
        }
    
    
    
        /* ----------------------------------------------------WHITESPACE END */
    
    
        /* ----------------------------------------------------READ MORE START */
    
        figure.snip1237 .read-more {
            display: inline-block;
            width: 100%;
            text-align: center;
            border: 2px solid #20638f;
            padding: 0.4em 0.6em;
            color: #ffffff;
            text-decoration: none;
            font-weight: 800;
            font-size: 0.9em;
            text-transform: uppercase;
            background-color: #20638f;
        }
    
        figure.snip1237 .read-more:hover {
            background-color: #ba2f00;
            color: #ffffff;
        }
    
        /* ----------------------------------------------------READ MORE END */
    
    
    
        /* ----------------------------------------------------HOVER START */
    
        figure.snip1237:hover:before,
        figure.snip1237.hover:before {
            -webkit-transition-delay: 0s;
            transition-delay: 0s;
            -webkit-transform: skew(-45deg) translateX(-50%);
            transform: skew(-45deg) translateX(-50%);
        }
    
        figure.snip1237:hover:after,
        figure.snip1237.hover:after {
            -webkit-transition-delay: 0.1s;
            transition-delay: 0.1s;
            -webkit-transform: skew(-45deg) translateX(-75%);
            transform: skew(-45deg) translateX(-75%);
        }
    
        /* ----------------------------------------------------HOVER END */
    
    
        /* Image Resizer */
        figure.snip1237:hover img,
        figure.snip1237.hover img {
            -webkit-transform: scale(25);
            transform: scale(1.25);
        }
    
        /* Demo purposes only */
        body {
            background-color: #ffffff;
        }
    </style>
</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="index.html">iCummenical</a>

            </div>
            <!-- /.navbar-header -->

            <ul class="nav navbar-top-links navbar-right">
                <li><a href="../../authentication.html"><i class="fas fa-sign-out-alt"></i>Sair</a>
                </li>
            </ul>

            <!-- /.navbar-top-links -->

            <div class="navbar-default sidebar" role="navigation">
                <div class="sidebar-nav navbar-collapse">
                    <ul class="nav" id="side-menu">
                        <li>
                            <a href="index.html"><i class="far fa-calendar-alt fa-fw"></i> Mural de Eventos</a>
                        </li>
                        <li>
                            <a href="localizacao.html"><i class="fas fa-map-marker-alt fa-fw"></i> Localização</a>
                        </li>
                        <li>
                            <a href="eventos.html"><i class="far fa-calendar-plus fa-fw"></i> Eventos</a>
                        </li>
                        <li>
                            <a href="paroquias.html"><i class="fas fa-church fa-fw"></i> Paróquias</a>
                        </li>
                        <li>
                            <a href="dizimo.html"><i class="fas fa-hand-holding-usd fa-fw"></i> Ofertar Dízimo</a>
                        </li>
                        <li>
                            <a href="voluntario.html"><i class="fas fa-user fa-fw"></i> Seja um Voluntário</a>
                        </li>
                        <li>
                            <a href="usuarios.html"><i class="fas fa-user-circle fa-fw"></i> Usuários</a>
                        </li>
                    </ul>
                </div>
                <!-- /.sidebar-collapse -->
            </div>
            <!-- /.navbar-static-side -->
        </nav>

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="page-header">Mural de Eventos</h1>

                    <div id="card-list">

                    </div>

                </div>
                <!-- /.col-lg-12 -->
            </div>
            <!-- /.row -->

        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>

    <!-- Morris Charts JavaScript -->
    <script src="../vendor/raphael/raphael.min.js"></script>
    <script src="../vendor/morrisjs/morris.min.js"></script>
    <script src="../data/morris-data.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="
        crossorigin="anonymous"></script>
    <script src="https://www.gstatic.com/firebasejs/4.10.0/firebase.js"></script>
    <script>
        var nextkey = 0;
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyBXTv9ar6lqLBhekXscqvI2kt6ZxUfctQA",
            authDomain: "icummenical.firebaseapp.com",
            databaseURL: "https://icummenical.firebaseio.com",
            projectId: "icummenical",
            storageBucket: "icummenical.appspot.com",
            messagingSenderId: "1047105331592"
        };
        firebase.initializeApp(config);
        var database = firebase.database();
        database.ref('Eventos').on('child_added', function (data) {
            add_data_table(
                data.val().titulo,
                data.val().profile_picture,
                data.val().descricao,
                data.val().atividades,
                data.val().local,
                data.val().dataEvento,
                data.val().horario,
                data.val().paroquia,
                data.key);

            var lastkey = data.key;
            nextkey = parseInt(lastkey) + 1;
        });
        database.ref('Eventos').on('child_changed', function (data) {
            update_data_table(
                data.val().titulo,
                data.val().profile_picture,
                data.val().descricao,
                data.val().atividades,
                data.val().local,
                data.val().dataEvento,
                data.val().horario,
                data.val().paroquia,
                data.key)
        });
        database.ref('Eventos').on('child_removed', function (data) {
            remove_data_table(data.key)
        });

        function add_data_table(titulo, pic, descricao, atividades, local, dataEvento, horario,
            paroquia, key) {
            $("#card-list").append('<figure class="snip1237"> <div class="image" id="truck"> <img src="' + pic +
                '" height="100%" width="100%"><em></em> </div> <figcaption> <h2 style="text-align:center;">' +
                titulo + '</h2><br> <p> ' + descricao + '</p> <p>' + atividades + '</p> <p>Paróquia: ' + paroquia +
                '</p> <p>Local: ' + local + '</p> <p>Data: ' + dataEvento + '</p> <p>Hora: ' + horario +
                '</p> <a href="' + pic + '" class="read-more">Abrir Imagem</a> </figcaption></figure>');
        }

        function update_data_table(titulo, pic, descricao, atividades, local, dataEvento, horario,
            paroquia, key) {
            $("#card-list #" + key).html(
                '<div class="card"> <div class="card-image"> <figure class="image is-4by3"><img src="' +
                pic +
                '"></figure> </div> <div class="card-content"> <div class="media"> <div class="media-content"> <p class="title is-4">' +
                titulo + '</p> <p class="subtitle is-6">' + descricao +
                '</p> <p class="subtitle is-6">' + atividades +
                '</p> <p class="subtitle is-6">Paróquia: ' + paroquia +
                '</p> <p class="subtitle is-6">Local: ' + local +
                '</p> <p class="subtitle is-6">Data: ' + dataEvento +
                '</p> <p class="subtitle is-6">Hora: ' + horario +
                '</p> </div> </div> </div> <footer class="card-footer"><a href="#" class="card-footer-item btnEdit" data-key="' +
                key + '">Editar</a><a data-key="' + key +
                '" href="#" class="card-footer-item btnRemove">Remover</a></footer></div>');
        }

        function remove_data_table(key) {
            $("#card-list #" + key).remove();
        }

        function new_data(titulo, descricao, atividades, local, dataEvento, horario, pic, paroquia, key) {
            database.ref('Eventos/' + key).set({
                titulo: titulo,
                descricao: descricao,
                atividades: atividades,
                local: local,
                dataEvento: dataEvento,
                horario: horario,
                profile_picture: pic,
                paroquia: paroquia
            });
        }

        function update_data(titulo, descricao, atividades, local, dataEvento, horario, pic, paroquia,
            key) {
            database.ref('Eventos/' + key).update({
                titulo: titulo,
                descricao: descricao,
                atividades: atividades,
                local: local,
                dataEvento: dataEvento,
                horario: horario,
                profile_picture: pic,
                paroquia: paroquia
            });
        }
        $("#btnAdd").click(function () {
            $("#txtTituloEvento").val("");
            $("#txtDescricaoEvento").val("");
            $("#txtAtividadesEvento").val("");
            $("#txtLocalEvento").val("");
            $("#txtDataEvento").val("");
            $("#txtHorarioEvento").val("");
            $("#txtPic").val("");
            $("#txtParoquia").val("");
            $("#txtType").val("N");
            $("#txtKey").val("0");
            $("#modal").addClass("is-active");

        });
        $("#btnSave").click(function () {
            if ($("#txtType").val() == 'N') {
                database.ref('Eventos').once("value").then(function (snapshot) {
                    if (snapshot.numChildren() == 0) {
                        nextkey = 1;
                    }
                    new_data(
                        $("#txtTituloEvento").val(),
                        $("#txtDescricaoEvento").val(),
                        $("#txtAtividadesEvento").val(),
                        $("#txtLocalEvento").val(),
                        $("#txtDataEvento").val(),
                        $("#txtHorarioEvento").val(),
                        $("#txtPic").val(),
                        $("#txtParoquia").val(),
                        nextkey);
                });
            } else {
                update_data(
                    $("#txtTituloEvento").val(),
                    $("#txtDescricaoEvento").val(),
                    $("#txtAtividadesEvento").val(),
                    $("#txtLocalEvento").val(),
                    $("#txtDataEvento").val(),
                    $("#txtHorarioEvento").val(),
                    $("#txtPic").val(),
                    $("#txtParoquia").val(),
                    $("#txtKey").val());
                location.reload();
            }
            $("#btnClose").click();

        });
        $(document).on("click", ".btnEdit", function (event) {
            event.preventDefault();
            key = $(this).attr("data-key");
            database.ref('Eventos/' + key).once("value").then(function (snapshot) {
                $("#txtTituloEvento").val(snapshot.val().titulo);
                $("#txtDescricaoEvento").val(snapshot.val().descricao);
                $("#txtAtividadesEvento").val(snapshot.val().atividades);
                $("#txtPic").val(snapshot.val().profile_picture);
                $("#txtLocalEvento").val(snapshot.val().local);
                $("#txtDataEvento").val(snapshot.val().dataEvento);
                $("#txtHorarioEvento").val(snapshot.val().horario);
                $("#txtParoquia").val(snapshot.val().paroquia);
                $("#txtType").val("E");
                $("#txtKey").val(key);
            });
            $("#modal").addClass("is-active");
        });
        $(document).on("click", ".btnRemove", function (event) {
            event.preventDefault();
            key = $(this).attr("data-key");
            database.ref('Eventos/' + key).remove();
        })

        $("#btnClose,.btnClose").click(function () {
            $("#modal").removeClass("is-active");
        });
    </script>

    </div>
    <!-- /.col-lg-12 -->
    </div>
    <!-- /.row -->

    </div>
    <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="../vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="../vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Metis Menu Plugin JavaScript -->
    <script src="../vendor/metisMenu/metisMenu.min.js"></script>

    <!-- Morris Charts JavaScript -->
    <script src="../vendor/raphael/raphael.min.js"></script>
    <script src="../vendor/morrisjs/morris.min.js"></script>
    <script src="../data/morris-data.js"></script>

    <!-- Custom Theme JavaScript -->
    <script src="../dist/js/sb-admin-2.js"></script>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="//www.gstatic.com/firebasejs/3.3.0/firebase.js"></script>
    <!------ Include the above in your HEAD tag ---------->

    <!-- -------------------------------------------------------------------------------------------START NEW MONTH------------------------------------------------------------------------------------------ -->


</body>

</html>